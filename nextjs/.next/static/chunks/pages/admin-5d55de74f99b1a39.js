(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{4730:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return n(4110)}])},7345:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var s=n(5893),r=n(7294),i=n(1664),l=n.n(i);let a=[{href:"/#about",label:"About Us"},{href:"/#awareness",label:"Awareness"},{href:"/collaborators",label:"Collaborators"},{href:"/projects",label:"Our Projects"},{href:"/suggestions",label:"Suggestions"},{href:"/#donations",label:"Donations"}];function c(e){let{children:t,fixedFooter:n=!1}=e,[i,c]=(0,r.useState)(null);async function d(){if(confirm("Sign out?"))try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error(e)}finally{c(null)}}return(0,r.useEffect)(()=>{let e=!0;return fetch("/api/auth/me").then(e=>e.json()).then(t=>{e&&c((null==t?void 0:t.user)||null)}).catch(()=>{}),()=>{e=!1}},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("header",{className:"container",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,s.jsx)("img",{id:"logo",src:"/images/LOGO.jpg",alt:"BRIDGING THE GAPS logo"}),(0,s.jsx)("h1",{children:"BRIDGING THE GAPS"})]}),(0,s.jsx)("nav",{"aria-label":"Primary navigation",children:(0,s.jsx)("ul",{children:a.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)(l(),{href:e.href,children:e.label})},e.href))})}),(0,s.jsx)("div",{className:"auth-area",children:i?(0,s.jsx)("img",{id:"userAvatar",className:"user-avatar",src:i.avatar||"/images/LOGO.jpg",alt:i.name||i.email||"Account",title:"Click to logout",onClick:d}):(0,s.jsxs)("div",{id:"authArea",className:"auth-actions",children:[(0,s.jsx)(l(),{href:"/login",className:"auth-btn",children:"Login"}),(0,s.jsx)(l(),{href:"/signup",className:"auth-btn",style:{background:"#0ea5a4"},children:"Register"})]})})]}),t,(0,s.jsx)("footer",{className:"site-footer ".concat(n?"fixed":""),children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("a",{href:"https://www.instagram.com/bridging.the.gaps/?hl=en",target:"_blank",rel:"noopener noreferrer","aria-label":"Instagram",children:(0,s.jsx)("img",{src:"/images/Insta_logo-removebg-preview.png",alt:"Instagram"})}),(0,s.jsxs)("a",{href:"mailto:unsdg10@gmail.com",className:"email-link","aria-label":"Email unsdg10",children:["Contact: ",(0,s.jsx)("span",{style:{marginLeft:6,textDecoration:"underline"},children:"unsdg10@gmail.com"})]}),(0,s.jsxs)("div",{className:"site-credit",style:{textAlign:"right"},children:[(0,s.jsxs)("p",{children:["Website designed by ",(0,s.jsx)("strong",{children:"MA Services"}),"."]}),(0,s.jsx)("a",{href:"https://www.instagram.com/ma_services_2025/",target:"_blank",rel:"noopener noreferrer","aria-label":"MA Services Instagram",children:(0,s.jsx)("img",{src:"/images/MA Services LOGO.jpg",alt:"MA Services Logo",style:{marginTop:6}})}),(0,s.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," BRIDGING THE GAPS. All rights reserved"]})]})]})})]})}},4110:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return c},default:function(){return d}});var s=n(5893),r=n(9008),i=n.n(r),l=n(7294),a=n(7345),c=!0;function d(e){let{users:t=[],donations:n=[],volunteers:r=[],projects:c=[],page:d=1,limit:h=20,csrf:o=""}=e,[j,x]=(0,l.useState)(t),[m,u]=(0,l.useState)(n),[g,f]=(0,l.useState)(r),[p,b]=(0,l.useState)(c);async function _(e,t){var n;let s=null===(n=document.querySelector('meta[name="csrf-token"]'))||void 0===n?void 0:n.getAttribute("content"),r=await fetch("/api/admin?action="+encodeURIComponent(e),{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":s||""},body:JSON.stringify(t)});return r.json()}async function v(e){await _("promote_user",{id:e});let t=j.map(t=>t.id===e?{...t,role:"admin"}:t);x(t)}async function y(e){await _("demote_user",{id:e});let t=j.map(t=>t.id===e?{...t,role:"user"}:t);x(t)}async function w(e){confirm("Delete user?")&&(await _("delete_user",{id:e}),x(j.filter(t=>t.id!==e)))}async function N(e){confirm("Delete donation?")&&(await _("delete_donation",{id:e}),u(m.filter(t=>t.id!==e)))}return(0,s.jsxs)(a.Z,{children:[(0,s.jsxs)(i(),{children:[(0,s.jsx)("title",{children:"Admin â€” BRIDGING THE GAPS"}),(0,s.jsx)("meta",{name:"csrf-token",content:o||""})]}),(0,s.jsxs)("main",{children:[(0,s.jsxs)("section",{children:[(0,s.jsx)("h1",{children:"Admin Dashboard"}),(0,s.jsx)("p",{className:"muted",children:"Manage registered users and review recorded donations."})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{children:"Users"}),(0,s.jsxs)("div",{style:{marginBottom:10},children:[(0,s.jsx)("a",{className:"btn",href:"/api/admin?action=export_users",children:"Export Users CSV"}),(0,s.jsx)("a",{className:"btn",style:{marginLeft:8},href:"/api/admin?action=export_donations",children:"Export Donations CSV"})]}),(0,s.jsxs)("table",{style:{width:"100%"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Email"}),(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Role"}),(0,s.jsx)("th",{children:"Created"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:j.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.email}),(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{children:e.role}),(0,s.jsx)("td",{children:e.created_at}),(0,s.jsxs)("td",{children:["admin"!==e.role?(0,s.jsx)("button",{onClick:()=>v(e.id),children:"Promote"}):(0,s.jsx)("button",{onClick:()=>y(e.id),children:"Demote"}),(0,s.jsx)("button",{onClick:()=>w(e.id),style:{marginLeft:8},children:"Delete"})]})]},e.id))})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{children:"Donations"}),(0,s.jsxs)("table",{style:{width:"100%"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Amount"}),(0,s.jsx)("th",{children:"User"}),(0,s.jsx)("th",{children:"Volunteer"}),(0,s.jsx)("th",{children:"Slip"}),(0,s.jsx)("th",{children:"Created"}),(0,s.jsx)("th",{children:"Actions"})]})}),(0,s.jsx)("tbody",{children:m.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{children:["RS ",e.amount]}),(0,s.jsx)("td",{children:e.user_email||"-"}),(0,s.jsx)("td",{children:e.volunteer_name||"-"}),(0,s.jsx)("td",{children:e.slip_path?(0,s.jsx)("a",{href:e.slip_path,children:"view"}):"-"}),(0,s.jsx)("td",{children:e.created_at}),(0,s.jsx)("td",{children:(0,s.jsx)("button",{onClick:()=>N(e.id),children:"Delete"})})]},e.id))})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{children:"Volunteers"}),(0,s.jsxs)("table",{style:{width:"100%"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Email"}),(0,s.jsx)("th",{children:"Phone"}),(0,s.jsx)("th",{children:"Projects Completed"}),(0,s.jsx)("th",{children:"Created"})]})}),(0,s.jsx)("tbody",{children:g.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{children:e.email}),(0,s.jsx)("td",{children:e.phone||"-"}),(0,s.jsx)("td",{children:e.Projects_completed}),(0,s.jsx)("td",{children:e.created_at})]},e.volunteer_id))})]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{children:"Projects"}),(0,s.jsxs)("table",{style:{width:"100%"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Description"}),(0,s.jsx)("th",{children:"Volunteer"}),(0,s.jsx)("th",{children:"Created"})]})}),(0,s.jsx)("tbody",{children:p.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{children:e.description?e.description.length>50?e.description.substring(0,50)+"...":e.description:"-"}),(0,s.jsx)("td",{children:e.volunteer_name||"-"}),(0,s.jsx)("td",{children:e.created_at})]},e.project_id))})]})]})]})]})}}},function(e){e.O(0,[664,774,888,179],function(){return e(e.s=4730)}),_N_E=e.O()}]);